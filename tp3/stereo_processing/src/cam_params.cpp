#include <opencv2/core.hpp>
#include "poses.hpp"

void setupStereoCameraMatrices(cv::Mat& D_left, cv::Mat& K_left, cv::Mat& R_left, cv::Mat& P_left,
                               cv::Mat& D_right, cv::Mat& K_right, cv::Mat& R_right, cv::Mat& P_right,
                               cv::Mat& T, cv::Mat& R) {
    // Left camera parameters
    D_left = (cv::Mat_<double>(1, 5) << -0.28528567852276154, 0.0755173390138138, 0.00042325617975809654, 6.82046332766036e-05, 0.0);
    K_left = (cv::Mat_<double>(3, 3) << 461.4083655730878, 0.0, 364.74303421116605,
                                        0.0, 460.1948345348428, 247.5842300899086,
                                        0.0, 0.0, 1.0);
    R_left = (cv::Mat_<double>(3, 3) << 0.9999291388891489, -0.0007704353780885541, -0.011879546697297074,
                                        0.0008675722844585223, 0.9999662172978196, 0.008173835172110863,
                                        0.011872847962317707, -0.008183562330537164, 0.9998960269892295);
    P_left = (cv::Mat_<double>(3, 4) << 439.40304644813335, 0.0, 383.1048240661621, 0.0,
                                        0.0, 439.40304644813335, 255.35926055908203, 0.0,
                                        0.0, 0.0, 1.0, 0.0);

    // Right camera parameters
    D_right = (cv::Mat_<double>(1, 5) << -0.2852945932144836, 0.07556094233309328, -0.00016457104721592913, 4.67978311690005e-05, 0.0);
    K_right = (cv::Mat_<double>(3, 3) << 461.22152512371986, 0.0, 373.630015164131,
                                         0.0, 460.3701926236939, 253.4813239671563,
                                         0.0, 0.0, 1.0);
    R_right = (cv::Mat_<double>(3, 3) << 0.999777876762165, -0.003390543364174486, -0.020801474770623506,
                                         0.003220288489111239, 0.9999610891135602, -0.00821279494868492,
                                         0.020828511204215524, 0.008143983946318862, 0.999749893046505);
    P_right = (cv::Mat_<double>(3, 4) << 439.40304644813335, 0.0, 383.1048240661621, -48.169298967129315,
                                         0.0, 439.40304644813335, 255.35926055908203, 0.0,
                                         0.0, 0.0, 1.0, 0.0);

    // Rotation and translation between the cameras
    T = (cv::Mat_<double>(3, 1) << -0.10960005816018638, 0.000371686310074846, 0.0022803493632622346);
    R = (cv::Mat_<double>(3, 3) << 0.9999571189710634, 0.0022794640328858873, 0.008975759734597452,
                                   -0.0024260722968527915, 0.9998632731202098, 0.016356932430961323,
                                   -0.008937247467810473, -0.01637800687090375, 0.9998259280988044);
}

float get_base_line_btw_cams() {
    cv::Mat t = (cv::Mat_<float>(3, 1) << -0.10960005816018638, 0.000371686310074846, 0.0022803493632622346);
    return cv::norm(t);
}

Pose get_left_cam_transform_wrt_body() {
    Pose pose = {0,
                 -0.0216401454975, -0.064676986768, 0.00981073058949,
                 -0.0077072, 0.0104993, 0.7017528, 0.7123015 };

    return pose;
}

Pose get_right_cam_transform_wrt_body() {
    Pose pose = {0,
                 -0.0198435579556, 0.0453689425024, 0.00786212447038,
                 -0.0025502, 0.0153239, 0.7024867, 0.7115273};

    return pose;
}